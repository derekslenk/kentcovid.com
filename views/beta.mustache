<!doctype html>
<html lang="en">
    <head>
        <title>Kent County, MI COVID-19 Tracker</title>
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <style>
            canvas {
                margin: 0 auto;
            }
            p {
                text-align: center;
            }
        </style>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js" integrity="sha256-R4pqcOYV8lt7snxMQO/HSbVCFRPMdrhAFMH+vr9giYI=" crossorigin="anonymous"></script>
        <script type="text/javascript" src="https://kentcovid.xyz/bootstrap/js/bootstrap.bundle.min.js"></script>
        <link href="https://kentcovid.xyz/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="css/product.css" rel="stylesheet">

    </head>

    <body class="bg-light">

        <nav class="site-header sticky-top py-1">
            <div class="container d-flex flex-column flex-md-row justify-content-between">
                <a class="py-2" href="#" aria-label="Kent Covid">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="d-block mx-auto" role="img" viewbox="0 0 24 24" focusable="false">
                        <title>Product</title><circle cx="12" cy="12" r="10"/><path d="M14.31 8l5.74 9.94M9.69 8h11.48M7.38 12l5.74-9.94M9.69 16L3.95 6.06M14.31 16H2.83m13.79-4l-5.74 9.94"/></svg>
                </a>
                <a class="py-2 d-none d-md-inline-block" href="#trend_chart">Trend Chart</a>
                <a class="py-2 d-none d-md-inline-block" href="#change_rate">Rate of Change</a>
                <a class="py-2 d-none d-md-inline-block" href="https://github.com/derekslenk/kentcovid.xyz">GitHub</a>
            </div>
        </nav>
        <div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 text-center bg-light">

            <canvas id="trend_chart" width="800" height="400"></canvas>
            <p>
                <i>* - denotes no official data from Kent County</i>
            </p>

        </div>

        <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3" id="change_rate">
            <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center text-white overflow-hidden">
                <canvas id="positive_change" width="400" height="400"></canvas>
            </div>
            <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center overflow-hidden">
                <canvas id="negative_change" width="400" height="400"></canvas>
            </div>
        </div>
        <p>Data sourced from
            <a href="https://www.accesskent.com/Health/coronavirus.htm">https://www.accesskent.com/Health/coronavirus.htm</a>
        </p>
        <p>All updates are automatic. Raw data from the Kent County website is stored in
            <a href="https://micovid-data.s3.us-east-2.amazonaws.com/">AWS</a>. Cleaned data is stored at
            <a href="https://kentcovid.xyz/data.json">data.json</a>
        </p>
        {{ ! <p>To see source, file an issue or improve my crappy code, check out <a href="https://github.com/derekslenk/kentcovid.xyz">GitHub</a></p> }}
        <p>Any preview work for this site can be seen at
            <a href="https://kentcovid.xyz/beta.php">https://kentcovid.xyz/beta.php</a>
        </p>

        <script>
            var ctx = document.getElementById("trend_chart").getContext("2d");         
        const colors = {
                    green: {
                        fill: '#e0eadf',
                        stroke: '#5eb84d',
                    },
                    lightBlue: {
                        stroke: '#6fccdd',
                    },
                    darkBlue: {
                        fill: '#92bed2',
                        stroke: '#3282bf',
                    },
                    purple: {
                        fill: '#8fa8c8',
                        stroke: '#75539e',
                    },
                    black: {
                        stroke: '#000000',
                    },
                };
        
                const negative = [{{#negative}}"{{.}}",{{/negative}}];
                const positive = [{{#positive}}"{{.}}",{{/positive}}];
                const pending = [{{#pending}}"{{.}}",{{/pending}}];
                const deaths = [{{#deaths}}"{{.}}",{{/deaths}}];
                const created_at = [{{#created_at}}"{{.}}",{{/created_at}}];
        
                const trend_chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: created_at,
                        datasets: [{
                            label: "Deaths",
                            fill: false,
                            backgroundColor: colors.purple.fill,
                            pointBackgroundColor: colors.black.stroke,
                            borderColor: colors.black.stroke,
                            pointHighlightStroke: colors.black.stroke,
                            borderCapStyle: 'butt',
                            data: deaths,
                        }, {
                            label: "Presumptive Positive",
                            fill: false,
                            backgroundColor: colors.darkBlue.fill,
                            pointBackgroundColor: colors.darkBlue.stroke,
                            borderColor: colors.darkBlue.stroke,
                            pointHighlightStroke: colors.darkBlue.stroke,
                            borderCapStyle: 'butt',
                            data: positive,
                        }]
                    },
                    options: {
                        responsive: false,
                        animation: {
                            duration: 750,
                        },
                        title: {
                            display: true,
                            text: 'Kent County, MI COVID-19 Tracker'
                        }
                    }
                });

        var ctx2 = document.getElementById("positive_change").getContext("2d");                             
        const positive_delta = [{{#positive_delta}}{x:'{{x}}', y:{{y}}}, {{/positive_delta}}];

        const positive_change = new Chart(ctx2, {
            type: 'bar',
            data: positive_delta,
             options: {
        scales: {
            xAxes: [{
                type: 'time',
            }],
            yAxes: [{
                ticks: {
                    sampleSize: 10,
                }
            }]
        }
    },
        });
</script>
                                                            
                                                    

</body>
</html>
